<div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
    <button (click)="toggleMainExpand()"
        class="w-full flex justify-between items-center text-lg font-semibold text-gray-800 focus:outline-none hover:text-blue-600 transition-colors">
        <div class="flex items-center gap-3">
            <div class="p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg text-white shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            </div>
            <span>Advanced Configuration</span>
        </div>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300"
            [class.rotate-180]="!isMainExpanded" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
    </button>

    <div *ngIf="isMainExpanded" class="mt-6 space-y-3 animate-fade-in-down">
        <p class="text-sm text-gray-500 mb-4 px-1">Fine-tune your architecture components for precise cost estimation.
        </p>

        <div *ngFor="let section of sections"
            class="border border-gray-100 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-md"
            [class.ring-2]="isExpanded(section.id)" [class.ring-blue-100]="isExpanded(section.id)"
            [class.bg-white]="!isExpanded(section.id)" [class.bg-gray-50]="isExpanded(section.id)">

            <!-- Card Header -->
            <button (click)="toggleSection(section.id)"
                class="w-full flex items-center justify-between p-4 text-left focus:outline-none">
                <div class="flex items-center gap-4">
                    <div class="p-2 rounded-lg bg-gray-50" [class.bg-white]="isExpanded(section.id)">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" [ngClass]="section.color" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                [attr.d]="section.icon" />
                        </svg>
                    </div>
                    <div>
                        <h4 class="text-base font-semibold text-gray-800">{{ section.title }}</h4>
                        <p class="text-xs text-gray-500 mt-0.5">{{ section.description }}</p>
                    </div>
                </div>

                <div class="flex items-center gap-2">
                    <span *ngIf="!isExpanded(section.id)"
                        class="text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded hidden sm:inline-block">Configure</span>
                    <svg xmlns="http://www.w3.org/2000/svg"
                        class="h-5 w-5 text-gray-400 transform transition-transform duration-300"
                        [class.rotate-180]="isExpanded(section.id)" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
            </button>

            <!-- Expanded Content -->
            <div *ngIf="isExpanded(section.id)" class="px-4 pb-4 animate-fade-in">
                <div class="h-px bg-gray-200 mb-4 w-full"></div>

                <ng-container [ngSwitch]="section.id">
                    <app-database-config *ngSwitchCase="'database'" [config]="traffic.database"
                        (configChange)="onChange()"></app-database-config>
                    <app-cdn-config *ngSwitchCase="'cdn'" [config]="traffic.cdn"
                        (configChange)="onChange()"></app-cdn-config>
                    <app-message-queue-config *ngSwitchCase="'messaging'" [config]="traffic.messaging"
                        (configChange)="onChange()"></app-message-queue-config>
                    <app-security-config *ngSwitchCase="'security'" [config]="traffic.security"
                        (configChange)="onChange()"></app-security-config>
                    <app-monitoring-config *ngSwitchCase="'monitoring'" [config]="traffic.monitoring"
                        (configChange)="onChange()"></app-monitoring-config>
                    <app-cicd-config *ngSwitchCase="'cicd'" [config]="traffic.cicd"
                        (configChange)="onChange()"></app-cicd-config>
                    <app-multi-region-config *ngSwitchCase="'multi_region'" [config]="traffic.multi_region"
                        (configChange)="onChange()"></app-multi-region-config>
                </ng-container>
            </div>
        </div>
    </div>
</div>